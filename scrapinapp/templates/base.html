{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}SQ1{% endblock %}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-100 font-sans">
    <!-- Simplified Loader -->
    <div
      id="preloader"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(255, 255, 255, 0.8);
        z-index: 9999;
        display: none;
      "
    >
      <div
        style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          text-align: center;
        "
      >
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"
        ></div>
        <p class="mt-4 text-gray-700 font-medium">Loading...</p>
      </div>
    </div>

    <!-- Header -->
    <header
      class="bg-white text-gray-800 p-4 flex items-center justify-between fixed top-0 left-0 w-full z-50 shadow"
    >
      <div class="flex items-center gap-4">
        <img
          src="{% static 'images/1731000892786.svg' %}"
          alt="Logo"
          class="h-10 w-auto object-contain"
        />
        <div>
          <div class="text-xl font-semibold leading-none">
            <span class="text-purple-500">SQ</span
            ><span class="text-pink-400">1</span>
          </div>
          <div class="text-sm text-gray-600">nxtgen cybersecurity</div>
        </div>
      </div>
      <div class="flex gap-3">
        <button
          onclick="syncData()"
          class="bg-blue-100 text-blue-800 font-semibold px-4 py-2 rounded hover:bg-blue-200 transition"
        >
          SYNC DATA
        </button>
        <a
          href="#"
          onclick="handleNavigation('{% url 'certifications' %}')"
          class="bg-purple-100 text-purple-800 font-semibold px-4 py-2 rounded hover:bg-purple-200 transition"
          >CERTIFICATIONS</a
        >
        <a
          href="#"
          onclick="handleNavigation('{% url 'policies' %}')"
          class="bg-green-100 text-green-800 font-semibold px-4 py-2 rounded hover:bg-green-200 transition"
          >POLICIES</a
        >
        <button
          onclick="showSection('controls-section')"
          class="bg-pink-100 text-pink-800 font-semibold px-4 py-2 rounded hover:bg-pink-200 transition"
        >
          CONTROLS
        </button>
      </div>
    </header>

    <!-- Main -->
    <main class="container mx-auto px-4 pt-24 pb-24">
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer
      class="bg-gray-800 text-white p-4 text-center fixed bottom-0 left-0 w-full z-50 shadow"
    >
      <p>&copy; 2025 SQ1 Security</p>
    </footer>

    <!-- JavaScript -->
    <script>
      function showSection(sectionId) {
        [
          "certifications-section",
          "policies-section",
          "controls-section",
        ].forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.classList.add("hidden");
        });
        const active = document.getElementById(sectionId);
        if (active) active.classList.remove("hidden");
      }

      function syncData() {
        const loader = document.getElementById("preloader");
        loader.style.display = "block";

        setTimeout(() => {
          loader.style.display = "none";
          alert("Sync button clicked - no operation performed");
        }, 5000);
      }

      function handleNavigation(url) {
        const loader = document.getElementById("preloader");
        loader.style.display = "block";

        const timeout = setTimeout(() => {
          loader.style.display = "none";
          window.location.href = "/certifications";
        }, 5000);

        fetch(url)
          .then((response) => {
            clearTimeout(timeout);
            loader.style.display = "none";
            window.location.href = url;
          })
          .catch(() => {
            clearTimeout(timeout);
            loader.style.display = "none";
            window.location.href = "/certifications";
          });
      }

      document.addEventListener("DOMContentLoaded", () => {
        showSection("certifications-section");
      });
    </script>
  </body>
</html>
